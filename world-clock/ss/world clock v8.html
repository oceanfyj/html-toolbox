<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>World Clock Pro 3.6</title>
    <style>
        :root {
            /* Global Layout Variables */
            --bg: #f0f2f5; 
            --card-bg: #ffffff; 
            --border: #e1e4e8;
            --accent: #0052cc; 
            
            /* DYNAMIC VARIABLES (Will change based on face pattern) */
            --text-color: #1a1a1a;    /* Default Dark Text */
            --hand-color: #333333;    /* Default Dark Hands */
            --num-color: #555555;
            --center-dot: #333333;
            --second-hand: #ff4757;

            /* Face Pattern Defaults */
            --face-bg: #f8f9fa;
            --face-border: 3px solid #e1e4e8;
            --face-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
        }

        /* --- DYNAMIC CONTRAST LOGIC --- */
        
        /* When Body has 'dark-ui' class (For Light Backgrounds) - DEFAULT */
        body.ui-dark {
            --text-color: #1a1a1a;
            --hand-color: #2d3436;
            --num-color: #2d3436;
            --center-dot: #2d3436;
            --card-bg: #ffffff;
            --bg: #f0f2f5;
        }

        /* When Body has 'light-ui' class (For Dark Backgrounds) */
        body.ui-light {
            --text-color: #ffffff;
            --hand-color: #ffffff;
            --num-color: #e0e0e0;
            --center-dot: #ffffff;
            --card-bg: #222222; /* Darker card for dark faces */
            --bg: #121212;      /* Darker background for dark faces */
            --border: #444;
            --face-border: 3px solid #555;
            --face-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }

        /* --- BASE STYLES --- */
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            background-color: var(--bg); color: var(--text-color); margin: 0; 
            display: flex; height: 100dvh; overflow: hidden; 
            transition: background 0.3s, color 0.3s;
        }
        
        /* SIDEBAR */
        .sidebar { 
            width: 280px; background: rgba(0,0,0,0.05); height: 100%; padding: 20px; box-sizing: border-box; 
            display: flex; flex-direction: column; border-right: 1px solid var(--border); overflow-y: auto; flex-shrink: 0; 
        }
        .sidebar-section { margin-bottom: 25px; }
        .sidebar h3 { font-size: 11px; text-transform: uppercase; letter-spacing: 1px; opacity: 0.6; margin-bottom: 10px; font-weight: 800; }

        #search-box { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border); box-sizing: border-box; background: var(--card-bg); color: var(--text-color); font-size: 16px; }
        .search-results { max-height: 200px; overflow-y: auto; background: var(--card-bg); border: 1px solid var(--border); border-radius: 6px; margin-top: 5px; display: none; }
        .search-item { padding: 12px; cursor: pointer; border-bottom: 1px solid var(--border); font-size: 14px; }
        .search-item:hover { opacity: 0.7; background: rgba(127,127,127,0.1); }

        .pattern-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .p-btn { padding: 10px; border: 1px solid var(--border); border-radius: 8px; cursor: pointer; font-size: 11px; font-weight: bold; background: var(--card-bg); color: var(--text-color); }
        .p-btn.active { border: 2px solid var(--accent); }

        /* MAIN CONTENT */
        .main-content { flex-grow: 1; padding: 40px; overflow-y: auto; -webkit-overflow-scrolling: touch; }
        .clock-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 25px; }
        .card { background: var(--card-bg); border-radius: 24px; padding: 25px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border: 1px solid var(--border); position: relative; transition: background 0.3s; }
        .rm-btn { position: absolute; top: 15px; right: 15px; background: none; border: none; color: #ff4757; cursor: pointer; font-size: 24px; font-weight: bold; padding: 10px; }

        /* CLOCK FACE */
        .clock { 
            width: 150px; height: 150px; border-radius: 50%; margin: 0 auto 15px; position: relative; 
            background: var(--face-bg); 
            background-size: cover !important; 
            background-position: center !important;
            border: var(--face-border); 
            box-shadow: var(--face-shadow); 
            transition: all 0.3s;
        }
        .clock::after { content: ''; position: absolute; top: 50%; left: 50%; width: 8px; height: 8px; background: var(--center-dot); border-radius: 50%; transform: translate(-50%, -50%); z-index: 4; }

        .hand { position: absolute; bottom: 50%; left: 50%; transform-origin: bottom; background: var(--hand-color); border-radius: 4px; transform: translateX(-50%); transition: background 0.3s; }
        .h-h { width: 5px; height: 40px; z-index: 3; }
        .m-h { width: 3px; height: 55px; z-index: 2; }
        .s-h { width: 1.5px; height: 60px; background: var(--second-hand); z-index: 1; }
        
        .clk-num { position: absolute; font-size: 18px; font-weight: bold; color: var(--num-color); width: 20px; height: 20px; line-height: 20px; text-align: center; }
        .n-12 { top: 8px; left: 50%; transform: translateX(-50%); }
        .n-6  { bottom: 8px; left: 50%; transform: translateX(-50%); }
        .n-3  { right: 8px; top: 50%; transform: translateY(-50%); }
        .n-9  { left: 8px; top: 50%; transform: translateY(-50%); }

        .digital { font-size: 1.6rem; font-weight: bold; font-family: 'Courier New', monospace; margin: 10px 0 5px; }
        .date { font-size: 0.9rem; opacity: 0.7; font-weight: 500; }
        .city { font-weight: bold; font-size: 1.2rem; margin-bottom: 5px; }

        /* MOBILE RESPONSIVE */
        @media (max-width: 800px) {
            body { flex-direction: column; }
            .sidebar { width: 100%; height: auto; max-height: 30vh; border-right: none; border-bottom: 1px solid var(--border); padding: 15px; }
            .main-content { padding: 20px; height: 70vh; }
            .clock-grid { grid-template-columns: 1fr; }
            .pattern-grid { grid-template-columns: repeat(4, 1fr); gap: 5px; }
            .p-btn { padding: 8px 2px; font-size: 9px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        }
    </style>
</head>
<body id="b" class="ui-dark">

    <div class="sidebar">
        <div class="sidebar-section">
            <h3 style="display:flex; justify-content:space-between;">üåç Add Location</h3>
            <input type="text" id="search-box" placeholder="Search (e.g. London, Japan)..." onkeyup="search()">
            <div id="results" class="search-results"></div>
        </div>

        <div class="sidebar-section">
            <h3>‚åö Clock Face Pattern</h3>
            <div class="pattern-grid">
                <button class="p-btn" onclick="sf(0)">Default</button>
                <button class="p-btn" onclick="sf(1)">Face 2</button>
                <button class="p-btn" onclick="sf(2)">Face 3</button>
                <button class="p-btn" onclick="sf(3)">Face 4</button>
                <button class="p-btn" onclick="sf(4)">Face 5</button>
                <button class="p-btn" onclick="sf(5)">Face 6</button>
                <button class="p-btn" onclick="sf(6)">Face 7</button>
                <button class="p-btn" onclick="sf(7)">Face 8</button>
            </div>
        </div>
        <p style="font-size: 9px; opacity: 0.5; margin-top: auto;">World Clock Pro 3.6</p>
    </div>

    <div class="main-content">
        <div class="clock-grid" id="grid">
            <div class="card" id="local-card">
                <div class="city">üìç Local Time</div>
                <div class="clock">
                    <div class="clk-num n-12">12</div><div class="clk-num n-3">3</div><div class="clk-num n-6">6</div><div class="clk-num n-9">9</div>
                    <div class="hand h-h" id="lh"></div><div class="hand m-h" id="lm"></div><div class="hand s-h" id="ls"></div>
                </div>
                <div class="digital" id="ld">--:--:-- --</div>
                <div class="date" id="ldt">Loading...</div>
            </div>
        </div>
    </div>

    <script>
        // ----------------------------------------------------
        // 1. CONFIGURATION: CLOCK FACE PATTERNS (8 Slots)
        // ----------------------------------------------------
        // uiMode: 'dark'  => For LIGHT backgrounds (Hands will be Black)
        // uiMode: 'light' => For DARK backgrounds (Hands will be White)
        // ----------------------------------------------------
        const patterns = [
            { name: "Default", uiMode: "dark",  url: "none" }, // 0: Default White
            { name: "Face 2",  uiMode: "light", url: "PASTE_URL_HERE" }, // 1: Placeholder
            { name: "Face 3",  uiMode: "dark",  url: "PASTE_URL_HERE" }, // 2: Placeholder
            { name: "Face 4",  uiMode: "light", url: "PASTE_URL_HERE" }, // 3: Placeholder
            { name: "Face 5",  uiMode: "dark",  url: "PASTE_URL_HERE" }, // 4: Placeholder
            { name: "Face 6",  uiMode: "light", url: "PASTE_URL_HERE" }, // 5: Placeholder
            { name: "Face 7",  uiMode: "dark",  url: "PASTE_URL_HERE" }, // 6: Placeholder
            { name: "Face 8",  uiMode: "light", url: "PASTE_URL_HERE" }  // 7: Placeholder
        ];

        // ----------------------------------------------------
        // 2. FULL DATABASE (Search Restored)
        // ----------------------------------------------------
        const countryDB = [
            {n: "Afghanistan (Kabul)", z: "Asia/Kabul"},
            {n: "Argentina (Buenos Aires)", z: "America/Argentina/Buenos_Aires"},
            {n: "Australia (Sydney)", z: "Australia/Sydney"},
            {n: "Australia (Melbourne)", z: "Australia/Melbourne"},
            {n: "Australia (Adelaide)", z: "Australia/Adelaide"},
            {n: "Australia (Perth)", z: "Australia/Perth"},
            {n: "Austria (Vienna)", z: "Europe/Vienna"},
            {n: "Bangladesh (Dhaka)", z: "Asia/Dhaka"},
            {n: "Belgium (Brussels)", z: "Europe/Brussels"},
            {n: "Brazil (Sao Paulo)", z: "America/Sao_Paulo"},
            {n: "Canada (Toronto)", z: "America/Toronto"},
            {n: "Canada (Vancouver)", z: "America/Vancouver"},
            {n: "Chile (Santiago)", z: "America/Santiago"},
            {n: "China (Beijing/Shanghai)", z: "Asia/Shanghai"},
            {n: "Denmark (Copenhagen)", z: "Europe/Copenhagen"},
            {n: "Egypt (Cairo)", z: "Africa/Cairo"},
            {n: "Finland (Helsinki)", z: "Europe/Helsinki"},
            {n: "France (Paris)", z: "Europe/Paris"},
            {n: "Germany (Berlin)", z: "Europe/Berlin"},
            {n: "Greece (Athens)", z: "Europe/Athens"},
            {n: "Hong Kong", z: "Asia/Hong_Kong"},
            {n: "India (New Delhi)", z: "Asia/Kolkata"},
            {n: "Indonesia (Jakarta)", z: "Asia/Jakarta"},
            {n: "Ireland (Dublin)", z: "Europe/Dublin"},
            {n: "Israel (Jerusalem)", z: "Asia/Jerusalem"},
            {n: "Italy (Rome)", z: "Europe/Rome"},
            {n: "Japan (Tokyo)", z: "Asia/Tokyo"},
            {n: "Jordan (Amman)", z: "Asia/Amman"},
            {n: "Kenya (Nairobi)", z: "Africa/Nairobi"},
            {n: "Korea South (Seoul)", z: "Asia/Seoul"},
            {n: "Malaysia (Kuala Lumpur)", z: "Asia/Kuala_Lumpur"},
            {n: "Mexico (Mexico City)", z: "America/Mexico_City"},
            {n: "Myanmar (Yangon)", z: "Asia/Yangon"},
            {n: "Nepal (Kathmandu)", z: "Asia/Kathmandu"},
            {n: "Netherlands (Amsterdam)", z: "Europe/Amsterdam"},
            {n: "New Zealand (Auckland)", z: "Pacific/Auckland"},
            {n: "Nigeria (Lagos)", z: "Africa/Lagos"},
            {n: "Norway (Oslo)", z: "Europe/Oslo"},
            {n: "Pakistan (Karachi)", z: "Asia/Karachi"},
            {n: "Philippines (Manila)", z: "Asia/Manila"},
            {n: "Poland (Warsaw)", z: "Europe/Warsaw"},
            {n: "Portugal (Lisbon)", z: "Europe/Lisbon"},
            {n: "Russia (Moscow)", z: "Europe/Moscow"},
            {n: "Saudi Arabia (Riyadh)", z: "Asia/Riyadh"},
            {n: "Singapore", z: "Asia/Singapore"},
            {n: "South Africa (Johannesburg)", z: "Africa/Johannesburg"},
            {n: "Spain (Madrid)", z: "Europe/Madrid"},
            {n: "Sweden (Stockholm)", z: "Europe/Stockholm"},
            {n: "Switzerland (Zurich)", z: "Europe/Zurich"},
            {n: "Taiwan (Taipei)", z: "Asia/Taipei"},
            {n: "Thailand (Bangkok)", z: "Asia/Bangkok"},
            {n: "Turkey (Istanbul)", z: "Europe/Istanbul"},
            {n: "UAE (Dubai)", z: "Asia/Dubai"},
            {n: "UK (London)", z: "Europe/London"},
            {n: "USA (New York)", z: "America/New_York"},
            {n: "USA (Chicago)", z: "America/Chicago"},
            {n: "USA (Denver)", z: "America/Denver"},
            {n: "USA (Los Angeles)", z: "America/Los_Angeles"},
            {n: "USA (Hawaii)", z: "Pacific/Honolulu"},
            {n: "Vietnam (Ho Chi Minh)", z: "Asia/Ho_Chi_Minh"}
        ];
        
        let clocks = [];
        let currentFace = 0; 

        function saveSettings() {
            const data = { list: clocks.map(c => ({n: c.name, z: c.zone})), face: currentFace };
            localStorage.setItem('wcpro_36_data', JSON.stringify(data));
        }

        // --- SET FACE PATTERN with DYNAMIC CONTRAST ---
        const sf = (idx) => {
            currentFace = idx;
            const p = patterns[idx];
            
            // 1. Set Background Image
            if(p.url === 'none') {
                document.documentElement.style.removeProperty('--face-bg');
            } else {
                document.documentElement.style.setProperty('--face-bg', `url('${p.url}')`);
            }

            // 2. Set Contrast Mode (Hands & Text Color)
            if(p.uiMode === 'light') {
                document.getElementById('b').className = 'ui-light'; // Dark bg, White hands
            } else {
                document.getElementById('b').className = 'ui-dark';  // Light bg, Black hands
            }

            // 3. Highlight active button
            document.querySelectorAll('.p-btn').forEach((btn, i) => {
                btn.classList.toggle('active', i === idx);
            });

            saveSettings();
        }

        function search() {
            const q = document.getElementById('search-box').value.toLowerCase();
            const resDiv = document.getElementById('results');
            if(!q) { resDiv.style.display = 'none'; return; }
            const filtered = countryDB.filter(c => c.n.toLowerCase().includes(q));
            resDiv.innerHTML = filtered.map(c => `<div class="search-item" onclick="add('${c.n}', '${c.z}')">${c.n}</div>`).join('');
            resDiv.style.display = filtered.length ? 'block' : 'none';
        }

        function add(name, zone, skipSave = false) {
            if(clocks.some(c => c.name === name)) { if(!skipSave) alert("Exists!"); document.getElementById('results').style.display='none'; return; }
            if(clocks.length >= 24) return alert("Max 24");
            const id = 'c' + Date.now() + Math.random().toString(16).slice(2);
            const div = document.createElement('div');
            div.className = 'card'; div.id = `card-${id}`;
            div.innerHTML = `<button class="rm-btn" onclick="rm('${id}')">√ó</button><div class="city">${name}</div>
                <div class="clock"><div class="clk-num n-12">12</div><div class="clk-num n-3">3</div><div class="clk-num n-6">6</div><div class="clk-num n-9">9</div>
                <div class="hand h-h" id="h-${id}"></div><div class="hand m-h" id="m-${id}"></div><div class="hand s-h" id="s-${id}"></div></div>
                <div class="digital" id="d-${id}">...</div><div class="date" id="dt-${id}">--</div>`;
            document.getElementById('grid').appendChild(div);
            clocks.push({ id, zone, name, dom: { h: document.getElementById(`h-${id}`), m: document.getElementById(`m-${id}`), s: document.getElementById(`s-${id}`), d: document.getElementById(`d-${id}`), dt: document.getElementById(`dt-${id}`) } });
            document.getElementById('search-box').value=''; document.getElementById('results').style.display='none';
            tick(); if(!skipSave) saveSettings();
        }

        function rm(id) {
            clocks = clocks.filter(c => c.id !== id);
            const card = document.getElementById(`card-${id}`);
            if(card) card.remove();
            saveSettings();
        }

        function tick() {
            const now = new Date();
            rotate('l', now);
            document.getElementById('ld').innerText = now.toLocaleTimeString('en-US', {hour12: true});
            document.getElementById('ldt').innerText = now.toLocaleDateString('en-US', {weekday:'short', month:'short', day:'numeric'});
            clocks.forEach(c => {
                const t = new Date(now.toLocaleString('en-US', {timeZone: c.zone}));
                c.dom.d.innerText = t.toLocaleTimeString('en-US', {hour12: true});
                c.dom.dt.innerText = t.toLocaleDateString('en-US', {weekday:'short', month:'short', day:'numeric'});
                rotateOther(c.dom, t);
            });
        }
        function rotate(id, date) { setHands(date, (s)=>document.getElementById(id+s)); }
        function rotateOther(dom, date) { setHands(date, (s)=>dom[s]); }
        function setHands(d, getEl) {
            const h=d.getHours(), m=d.getMinutes(), s=d.getSeconds();
            if(getEl('h')) getEl('h').style.transform=`translateX(-50%) rotate(${(h%12)*30+m*0.5}deg)`;
            if(getEl('m')) getEl('m').style.transform=`translateX(-50%) rotate(${m*6}deg)`;
            if(getEl('s')) getEl('s').style.transform=`translateX(-50%) rotate(${s*6}deg)`;
        }

        function loadSettings() {
            const saved = localStorage.getItem('wcpro_36_data');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    // Load Face First (to set logic)
                    if(data.face !== undefined) sf(data.face); 
                    else sf(0);
                    // Load Clocks
                    if(data.list) data.list.forEach(c => add(c.n, c.z, true));
                } catch(e) {}
            } else {
                sf(0); // Default Init
            }
        }
        loadSettings(); setInterval(tick, 1000); tick();
    </script>
</body>
</html>